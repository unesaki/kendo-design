== 記録管理機能

=== 機能概要

本サービスでは、剣道大会における個人戦および団体戦の結果を、ユーザが自主的に記録・保存・管理することができる。記録対象は公式大会・非公式試合・練習試合などを問わず、自由に入力可能である。

記録はデフォルトで「自分のみ閲覧可能」となり、現在操作中のクラブに対してのみ公開可能とする。また、記録の編集・削除にも対応し、誤登録や後日の修正が可能である。

=== 詳細設計書

本機能の詳細な技術仕様については、以下の詳細設計書を参照すること：

==== 共通定義
* link:../recordsManagement/common-definitions.adoc[記録管理機能 共通定義]

==== 実装済み機能
* link:../recordsManagement/personalMatches/create-personal-match-record.adoc[個人戦記録登録API 詳細設計書]
* link:../recordsManagement/teamMatches/create-team-match-record.adoc[団体戦記録登録API 詳細設計書]
* link:../recordsManagement/record-search-viewing.adoc[記録閲覧・検索API 詳細設計書]
* link:../recordsManagement/record-edit-delete.adoc[記録編集・削除API 詳細設計書]

==== その他の関連機能
* link:../recordsManagement/teamMatches/fetch-team-match-record-list.adoc[団体戦記録一覧取得API]
* link:../recordsManagement/teamMatches/update-team-match-visibility.adoc[記録公開設定変更API]
* link:../recordsManagement/common/create-record-edit-request.adoc[記録編集申請API]

==== 将来拡張機能
* link:../recordsManagement/TODO%20.adoc[実装予定機能一覧]
  - 承認後の通知機能
  - 添付ファイル管理機能
  - 共有リンク機能

=== 対象ユーザ

全ユーザ（管理者・参加者問わず）

* クラブ公開機能は、現在選択中のクラブにのみ適用可能（他クラブには非公開）

=== 機能一覧と詳細

[cols="1,1,2", options="header"]
|===
| 分類 | 機能名 | 説明

| 個人戦
| 個人戦結果の登録
| ユーザが自身または他選手との個人戦結果を記録する

| 個人戦
| 個人戦記録の閲覧
| 自分の登録した個人戦記録を一覧／詳細表示で確認できる

| 個人戦
| 個人戦記録の編集
| 登録済みの個人戦記録の内容を修正できる

| 個人戦
| 個人戦記録の削除
| 登録済みの個人戦記録を削除できる

| 団体戦
| 団体戦結果の登録
| 団体戦の1試合分（先鋒〜大将）をまとめて記録する

| 団体戦
| 団体戦記録の閲覧
| 自分の登録した団体戦記録を一覧／詳細表示で確認できる

| 団体戦
| 団体戦記録の編集
| 登録済みの団体戦記録の内容を修正できる

| 団体戦
| 団体戦記録の削除
| 登録済みの団体戦記録を削除できる

| 共通
| クラブへの記録公開
| 現在選択中のクラブに対してのみ記録を公開できる（任意設定）
|===

=== 入力項目定義

==== 団体戦記録

* 大会名（テキスト）
* 試合日（カレンダー入力）
* 試合ラウンド（例：1回戦、準決勝など）
* 赤チーム名
* 赤チームの選手構成（先鋒〜大将）名前
* 赤チーム各選手のスコア（最大2つまで選択）
** メ（面）
** コ（小手）
** ド（胴）
** ツ（突き）
** 反（反則による得点）
** 不（不戦勝）※2本換算
** ▲（反則）※1つまで登録可能、取得本数には含まれない
* 白チームの選手構成（先鋒〜大将）名前
* 白チーム各選手のスコア（上記と同様）
* 白チーム名

==== 個人戦記録

* 大会名（テキスト）
* 試合日（カレンダー入力）
* 試合ラウンド（例：1回戦、準決勝など）
* 赤選手名
* 赤選手の所属クラブ名
* 赤選手のスコア（最大2つまで選択）
* 白選手名
* 白選手の所属クラブ名
* 白選手のスコア（最大2つまで選択）

=== スコア判定仕様（剣道ルール準拠）

* **取得本数としてカウントされるスコア**：メ、コ、ド、ツ、反、不（不＝2本）
* **▲（反則）**
** 1つまで記録可能
** 2つ目の反則が記録された場合、相手に反則1本が与えられる（UI上で自動反映）
** ▲は「取得本数」および「引き分け判定」には一切影響しない

* **引き分けの条件**
** 両者の取得本数が0本または1本同士のとき成立
** ▲の有無は無関係

=== 公開範囲仕様

[cols="1,2", options="header"]
|===
| 公開設定 | 説明

| 自分のみ
| デフォルト設定。他ユーザ・クラブからは非公開

| 所属クラブ
| 現在選択中のクラブのみに公開可能。複数所属クラブがあっても、他クラブへは非公開
|===